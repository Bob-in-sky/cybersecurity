# Recon

To start searching for vulnerabilities we must scan the available ports which we can use to jump-start an exploit

```shell
root@BoB~# nmap -sV -vv --script vuln 10.10.190.171
Starting Nmap 7.80 ( https://nmap.org ) at 2025-02-07 18:04 GMT
NSE: Loaded 149 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 18:04
Completed NSE at 18:04, 10.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 18:04
Completed NSE at 18:04, 0.00s elapsed
Initiating ARP Ping Scan at 18:04
Scanning 10.10.190.171 [1 port]
Completed ARP Ping Scan at 18:04, 0.03s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 18:04
Completed Parallel DNS resolution of 1 host. at 18:04, 0.00s elapsed
Initiating SYN Stealth Scan at 18:04
Scanning 10.10.190.171 [1000 ports]
Discovered open port 135/tcp on 10.10.190.171
Discovered open port 3389/tcp on 10.10.190.171
Discovered open port 445/tcp on 10.10.190.171
Increasing send delay for 10.10.190.171 from 0 to 5 due to 71 out of 235 dropped probes since last increase.
Discovered open port 139/tcp on 10.10.190.171
Discovered open port 49154/tcp on 10.10.190.171
Discovered open port 49160/tcp on 10.10.190.171
Discovered open port 49153/tcp on 10.10.190.171
Discovered open port 49158/tcp on 10.10.190.171
Discovered open port 49152/tcp on 10.10.190.171
Completed SYN Stealth Scan at 18:04, 5.10s elapsed (1000 total ports)
Initiating Service scan at 18:04
Scanning 9 services on 10.10.190.171
Service scan Timing: About 44.44% done; ETC: 18:06 (0:01:08 remaining)
Completed Service scan at 18:05, 81.36s elapsed (9 services on 1 host)
NSE: Script scanning 10.10.190.171.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 18:05
NSE Timing: About 99.91% done; ETC: 18:06 (0:00:00 remaining)
Completed NSE at 18:06, 32.82s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 18:06
NSE: [ssl-ccs-injection 10.10.190.171:3389] No response from server: ERROR
NSE Timing: About 98.99% done; ETC: 18:06 (0:00:00 remaining)
Completed NSE at 18:06, 30.16s elapsed
Nmap scan report for 10.10.190.171
Host is up, received arp-response (0.00036s latency).
Scanned at 2025-02-07 18:04:21 GMT for 150s
Not shown: 991 closed ports
Reason: 991 resets
PORT      STATE SERVICE        REASON          VERSION
135/tcp   open  msrpc          syn-ack ttl 128 Microsoft Windows RPC
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
139/tcp   open  netbios-ssn    syn-ack ttl 128 Microsoft Windows netbios-ssn
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
445/tcp   open  microsoft-ds   syn-ack ttl 128 Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
3389/tcp  open  ms-wbt-server? syn-ack ttl 128
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
| rdp-vuln-ms12-020: 
|   VULNERABLE:
|   MS12-020 Remote Desktop Protocol Denial Of Service Vulnerability
|     State: VULNERABLE
|     IDs:  CVE:CVE-2012-0152
|     Risk factor: Medium  CVSSv2: 4.3 (MEDIUM) (AV:N/AC:M/Au:N/C:N/I:N/A:P)
|           Remote Desktop Protocol vulnerability that could allow remote attackers to cause a denial of service.
|           
|     Disclosure date: 2012-03-13
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0152
|       http://technet.microsoft.com/en-us/security/bulletin/ms12-020
|   
|   MS12-020 Remote Desktop Protocol Remote Code Execution Vulnerability
|     State: VULNERABLE
|     IDs:  CVE:CVE-2012-0002
|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)
|           Remote Desktop Protocol vulnerability that could allow remote attackers to execute arbitrary code on the targeted system.
|           
|     Disclosure date: 2012-03-13
|     References:
|       http://technet.microsoft.com/en-us/security/bulletin/ms12-020
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0002
|_ssl-ccs-injection: No reply from server (TIMEOUT)
|_sslv2-drown: 
49152/tcp open  msrpc          syn-ack ttl 128 Microsoft Windows RPC
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
49153/tcp open  msrpc          syn-ack ttl 128 Microsoft Windows RPC
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
49154/tcp open  msrpc          syn-ack ttl 128 Microsoft Windows RPC
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
49158/tcp open  msrpc          syn-ack ttl 128 Microsoft Windows RPC
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
49160/tcp open  msrpc          syn-ack ttl 128 Microsoft Windows RPC
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
MAC Address: 02:A8:82:75:68:C9 (Unknown)
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 18:06
Completed NSE at 18:06, 0.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 18:06
Completed NSE at 18:06, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 160.73 seconds
           Raw packets sent: 1077 (47.372KB) | Rcvd: 1002 (40.108KB)
root@BoB~# 
```

&nbsp;

After scanning we can see that it is vulnerable to ms17-010:

```
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft 
```

So we have identified a vulnerability that can be exploited with metasploit